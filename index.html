<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Compiling NIR to FPGAs</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/dist/reveal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/dist/theme/white.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/plugin/highlight/monokai.css">
</head>

<!--
Structure:
* 14:20--14:30: (Setup)
* 14:30--14:40: Context (current pipelines, why they are not interoperable). Speaker: Michail
* 14:40--15:05: Introduction to NIR. Speaker: Jens
* 15:05--15:20: From NIR graphs to SpinalHDL abstractions. Speaker: Michail
* 15:20--15:30: FPGA mapping and core demos. Speaker: Michail

- Introduction to co-design for on-device learning

- Proposed Structure
    1. Context [10 min]
       - [1] Neuromorphic toolchains: what do they do?
       - [3] Top-down hardware design approaches
       - [3] Bottom-up hardware approaches
       - [3] Introduce co-design
    2. Introduction to NIR [25 min]
       - [3] Historical context: existing IRs
       - [5] NIR design principles
       - [5] NIR ODE primitives (example: breaking down LIF)
       - [5] Show graphs (nirviz)
       - [3] Existing platforms + future work
       - [2] Q&A
    3. NIR Compilation Flow [15 min]
       - [2] So let's say you want to make an FPGA accalerator...
       - [4] Why not use NIR's primitives as a component spec?
       - [4] NIR's graph serves as a good language
       - [4] Our toolchain & "Our hardware language" (SpinalHDL)
       - [1] BTW Spiker+ exists
    4. FPGA mapping demo [10 min]
       - [2] Pick sinabs, define Affine -> IF
       - [2] Show exporting to NIR & JSON
       - [1] Write a SpinalHDL main function creating an accelerator
       - [2] Compilation & traces
       - [3] Oops, it should have been 20 neurons (sinabs -> compile -> traces)
  -->
<body>
    <div class="reveal">
        <div class="slides">
            <section>
                <h1>Introduction to co-design for on-device learning</h1>
                <h4>Michail Rontionov, University of Southhampton</h4>
                <h4>Jens E. Pedersen, Technical University of Denmark</h4>
            </section>
            <section>
              <h2>Agenda</h2>
              <ul class="fragment">
                <li>Approaches to neuromorphic toolchains</li>
                <li>Introduction to NIR</li>
                <li>Motivating work: NIR &rarr; FPGA Compiler</li>
                <li>Compilation Demonstration</li>
              </ul>
            </section>
            <section>
                <section>
                    <h1>Approaches to neuromorphic toolchains</h1>
                </section>
                <section>
                  <h2><u> Neuromorphic Toolchains: What do they do?</u> </h2>
                  <div style="height:0.5cm"></div>
                  <center>
                    <em>A neuromorphic toolchain describes the processes involved in transforming the idea of an algorithm to its execution on a given hardware platform.</em>
                  </center>
                  <div style="height:1.0cm"></div>

                  <div style="display: flex; gap: 2em; align-items: flex-start;">
                  <div style="flex: 1;">
                    <div style="text-align: left;">
                      <p class="fragment" data-fragment-index="2">Typically, they encode three important parts:</p>
                      <ol style="margin-left: 0; padding-left: 2em;">
                        <li class="fragment" data-fragment-index="3">Network Conception and Simulation.</li>
                        <li class="fragment" data-fragment-index="4">Translation to Hardware Representation.</li>
                        <li class="fragment" data-fragment-index="5">Hardware Execution.</li>
                      </ol>
                    </div>
                  </div>
                  <div style="flex: 1; display: flex; flex-direction: row; align-items: center; justify-content: center;">
                    <img class="fragment" data-fragment-index="3" src="img/brain.svg" alt="Absrtract brain" style="width: 50%; max-width: 300px;">
                    <span class="fragment" data-fragment-index="4" style="font-size: 3em; margin: 0 10px;">&#8594;</span>
                    <img class="fragment" data-fragment-index="4" src="img/square.svg" alt="Square wave" style="width: 50%; max-width: 300px;">
                    <span class="fragment" data-fragment-index="5" style="font-size: 3em; margin: 0 10px;">&#8594;</span>
                    <img class="fragment" data-fragment-index="5" src="img/hardware.svg" alt="Hardware" style="width: 50%; max-width: 300px;">
                  </div>
                </section>
                <section>
                  <h2><u> Network Simulators</u> </h2>
                  <div style="height:0.2cm"></div>
                  <p> The one you pick typically depends on where you're coming from. </p>
                  <div style="height:0.6cm"></div>
                  <div style="display: flex; gap: 2rem; align-items: stretch;">
                    <!-- Left column -->
                    <div class="fragment" data-fragment-index="1" style="flex: 1; text-align: center;">
                      <h4>Neuro-science</h4>
                      <img src="img/brian.png" alt="Image 1" style="width: 100mm; max-width: 100%; height: auto; margin: 1rem auto; display: block;">
                      <img src="img/nengo.svg" alt="Image 2" style="width: 100mm; max-width: 100%; height: auto; margin: 1rem auto; display: block;">
                    </div>

                    <!-- Dividing line -->
                    <div style="width: 2px; background: #ccc; margin: 0 1rem;"></div>

                    <!-- Right column -->
                    <div class="fragment" data-fragment-index="2" style="flex: 1; text-align: center;">
                      <h4>Machine Learning</h4>
                      <img src="img/sinabs.webp" alt="Image 1" style="width: 100mm; max-width: 100%; height: auto; margin: 1rem auto; display: block;">
                      <img src="img/norse.png" alt="Image 1" style="width: 100mm; max-width: 100%; height: auto; margin: 1rem auto; display: block;">
                      <img src="img/lava.png" alt="Image 1" style="width: 100mm; max-width: 100%; height: auto; margin: 1rem auto; display: block;">
                      <img src="img/pynn.png" alt="Image 1" style="width: 30mm; max-width: 100%; margin: 1rem auto; display: block;">
                    </div>
                  </div>
                </section>
                <section>
                  <h2><u> Hardware Representation</u> </h2>
                  <div style="height:0.2cm"></div>
                  <p> If your simulator was built for your hardware, you're in a good position.. </p>
                  <!-- Row 1: Sinabs → Speck -->
                  <div style="display: flex; align-items: center; gap: 0rem; margin: 0.3rem 0;">
                    <div style="flex: 1; text-align: center;">
                      <img src="img/sinabs.webp" alt="Sinabs" style="width: auto; height: 40mm; max-height: 100%;">
                    </div>
                    <div style="font-size: 3rem; color: #666;">→</div>
                    <div style="flex: 1; text-align: center;">
                      <img src="img/speck.png" alt="Speck" style="width: auto; height: 70mm; max-height: 100%;">
                    </div>
                  </div>
                  <!-- Row 2: Lava → Loihi -->
                  <div style="display: flex; align-items: center; gap: 0rem; margin: 0.3rem 0;">
                    <div style="flex: 1; text-align: center;">
                      <img src="img/lava.png" alt="Lava" style="width: auto; height: 30mm; max-height: 100%;">
                    </div>
                    <div style="font-size: 3rem; color: #666;">→</div>
                    <div style="flex: 1; text-align: center;">
                      <img src="img/loihi.jpg" alt="Loihi" style="width: auto; height: 60mm; max-height: 100%;">
                    </div>
                  </div>
                  <!-- Row 3: PyNN → SpiNNaker -->
                  <div style="display: flex; align-items: center; gap: 0rem; margin: 0.3rem 0;">
                    <div style="flex: 1; text-align: center;">
                      <img src="img/pynn.png" alt="PyNN" style="width: auto;">
                    </div>
                    <div style="font-size: 3rem; color: #666;">→</div>
                    <div style="flex: 1; text-align: center;">
                      <img src="img/spinnaker.jpg" alt="SpiNNaker" style="width: auto; height: 60mm; max-height: 100%;">
                    </div>
                  </div>
                </section>
                <section>
                  <h2><u> Hardware Representation</u> </h2>
                  <div style="height:0.2cm"></div>
                  <p> But neuromorphics is a young field.</p>
                  <ul>
                    <li class="fragment"> What if your simulator or hardware doesn't support your model? </li>
                    <li class="fragment"> What if an iteration of your existing network isn't supported by your simulator or hardware? </li>
                    <li class="fragment"> What if your hardware doesn't have the representational accuracy required? </li>
                    <li class="fragment"> What if you no longer have access to the hardware and need to use something else? </li>
                    <li class="fragment"> How can you evaluate your algorithm across various hardware paradigms? </li>
                    <li class="fragment"> &hellip; </li>
                  </ul>
                  <div style="height:0.5cm"></div>
                  <p> You're stuck! You need to either port your code to another one
                </section>
            </section>
            <section>
              <section>
                <h2>Introduction to NIR</h2>
              </section>
            </section>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/dist/reveal.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/plugin/notes/notes.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/plugin/markdown/markdown.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/plugin/highlight/highlight.js"></script>
    <script>
        Reveal.initialize({
            hash: true,
            plugins: [RevealMarkdown, RevealHighlight, RevealNotes],
            width: 1920,
            height: 1080
        });
    </script>
</body>

</html>
