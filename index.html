<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Compiling NIR to FPGAs</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/dist/reveal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/dist/theme/white.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/plugin/highlight/monokai.css">

    <style>
        .ecosystem-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }

        .platform-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }

        .timeline {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 2rem 0;
        }

        .timeline-item {
            text-align: center;
            flex: 1;
        }

        .timeline-arrow {
            font-size: 2rem;
            color: #667eea;
        }
    </style>
</head>

<!--
Structure:
* 14:20--14:30: (Setup)
* 14:30--14:40: Context (current pipelines, why they are not interoperable). Speaker: Michail
* 14:40--15:05: Introduction to NIR. Speaker: Jens
* 15:05--15:20: From NIR graphs to SpinalHDL abstractions. Speaker: Michail
* 15:20--15:30: FPGA mapping and core demos. Speaker: Michail

- Introduction to co-design for on-device learning

- Proposed Structure
    1. Context [10 min]
       - [1] Neuromorphic toolchains: what do they do?
       - [3] Top-down hardware design approaches
       - [3] Bottom-up hardware approaches
       - [3] Introduce co-design
    2. Introduction to NIR [25 min]
       - [3] Historical context: existing IRs
       - [5] NIR design principles
       - [5] NIR ODE primitives (example: breaking down LIF)
       - [5] Show graphs (nirviz)
       - [3] Existing platforms + future work
       - [2] Q&A
    3. NIR Compilation Flow [15 min]
       - [2] So let's say you want to make an FPGA accalerator...
       - [4] Why not use NIR's primitives as a component spec?
       - [4] NIR's graph serves as a good language
       - [4] Our toolchain & "Our hardware language" (SpinalHDL)
       - [1] BTW Spiker+ exists
    4. FPGA mapping demo [10 min]
       - [2] Pick sinabs, define Affine -> IF
       - [2] Show exporting to NIR & JSON
       - [1] Write a SpinalHDL main function creating an accelerator
       - [2] Compilation & traces
       - [3] Oops, it should have been 20 neurons (sinabs -> compile -> traces)
  -->

<body>
    <div class="reveal">
        <div class="slides">
            <section>
                <h1>Introduction to co-design <br /> for on-device learning</h1>
                <h4>Michail Rontionov, University of Southhampton</h4>
                <h4>Jens E. Pedersen, Technical University of Denmark</h4>
            </section>
            <section>
              <h2>Agenda</h2>
              <ol style="font-size: 150%;">
                <li>Current neuromorphic toolchains</li>
                <li>The Neuromorphic Intermediate Representation (NIR)</li>
                <li>Motivating work: NIR &rarr; FPGA Compiler</li>
                <li>Compilation Demonstration</li>
              </ol>
            </section>
            <section>
                <section>
                    <h1>Current neuromorphic toolchains</h1>
                </section>
                <section>
                  <h2><u> Neuromorphic Toolchains: What do they do?</u> </h2>
                  <div style="height:0.5cm"></div>
                  <center>
                    <em>A neuromorphic toolchain describes the processes involved in transforming the idea of an algorithm to its execution on hardware.</em>
                  </center>
                  <div style="height:1.0cm"></div>

                    <div style="display: flex; gap: 2em; align-items: flex-start;">
                        <div style="flex: 1;">
                            <div style="text-align: left;">
                                <p class="fragment" data-fragment-index="2">Typically, they encode three important
                                    parts:</p>
                                <ol style="margin-left: 0; padding-left: 2em;">
                                    <li class="fragment" data-fragment-index="3">Network Conception and Simulation.</li>
                                    <li class="fragment" data-fragment-index="4">Translation to Hardware Representation.
                                    </li>
                                    <li class="fragment" data-fragment-index="5">Hardware Execution.</li>
                                </ol>
                            </div>
                        </div>
                        <div
                            style="flex: 1; display: flex; flex-direction: row; align-items: center; justify-content: center;">
                            <img class="fragment" data-fragment-index="3" src="img/brain.svg" alt="Absrtract brain"
                                style="width: 50%; max-width: 300px;">
                            <span class="fragment" data-fragment-index="4"
                                style="font-size: 3em; margin: 0 10px;">&#8594;</span>
                            <img class="fragment" data-fragment-index="4" src="img/square.svg" alt="Square wave"
                                style="width: 50%; max-width: 300px;">
                            <span class="fragment" data-fragment-index="5"
                                style="font-size: 3em; margin: 0 10px;">&#8594;</span>
                            <img class="fragment" data-fragment-index="5" src="img/hardware.svg" alt="Hardware"
                                style="width: 50%; max-width: 300px;">
                        </div>
                </section>
                <section>
                    <h2><u> Network Simulators</u> </h2>
                    <div style="height:0.2cm"></div>
                    <p> The one you pick typically depends on where you're coming from. </p>
                    <div style="height:0.6cm"></div>
                    <div style="display: flex; gap: 2rem; align-items: stretch;">
                        <!-- Left column -->
                        <div class="fragment" data-fragment-index="1" style="flex: 1; text-align: center;">
                            <h4>Neuro-science</h4>
                            <img src="img/brian.png" alt="Image 1"
                                style="width: 100mm; max-width: 100%; height: auto; margin: 1rem auto; display: block;">
                            <img src="img/nengo.svg" alt="Image 2"
                                style="width: 100mm; max-width: 100%; height: auto; margin: 1rem auto; display: block;">
                        </div>

                        <!-- Dividing line -->
                        <div style="width: 2px; background: #ccc; margin: 0 1rem;"></div>

                        <!-- Right column -->
                        <div class="fragment" data-fragment-index="2" style="flex: 1; text-align: center;">
                            <h4>Machine Learning</h4>
                            <img src="img/sinabs.webp" alt="Image 1"
                                style="width: 100mm; max-width: 100%; height: auto; margin: 1rem auto; display: block;">
                            <img src="img/norse.png" alt="Image 1"
                                style="width: 100mm; max-width: 100%; height: auto; margin: 1rem auto; display: block;">
                            <img src="img/lava.png" alt="Image 1"
                                style="width: 100mm; max-width: 100%; height: auto; margin: 1rem auto; display: block;">
                            <img src="img/pynn.png" alt="Image 1"
                                style="width: 30mm; max-width: 100%; margin: 1rem auto; display: block;">
                        </div>
                    </div>
                </section>
                <section>
                  <h2><u> Hardware Representation</u> </h2>
                  <div style="height:0.2cm"></div>
                  <p> If your simulator was built for your hardware, you're in a good position. </p>
                  <!-- Row 1: Sinabs ‚Üí Speck -->
                  <div style="display: flex; align-items: center; gap: 0rem; margin: 0.3rem 0;">
                    <div style="flex: 1; text-align: center;">
                      <img src="img/sinabs.webp" alt="Sinabs" style="width: auto; height: 40mm; max-height: 100%;">
                    </div>
                    <!-- Row 2: Lava ‚Üí Loihi -->
                    <div style="display: flex; align-items: center; gap: 0rem; margin: 0.3rem 0;">
                        <div style="flex: 1; text-align: center;">
                            <img src="img/lava.png" alt="Lava" style="width: auto; height: 30mm; max-height: 100%;">
                        </div>
                        <div style="font-size: 3rem; color: #666;">‚Üí</div>
                        <div style="flex: 1; text-align: center;">
                            <img src="img/loihi.jpg" alt="Loihi" style="width: auto; height: 60mm; max-height: 100%;">
                        </div>
                    </div>
                    <!-- Row 3: PyNN ‚Üí SpiNNaker -->
                    <div style="display: flex; align-items: center; gap: 0rem; margin: 0.3rem 0;">
                        <div style="flex: 1; text-align: center;">
                            <img src="img/pynn.png" alt="PyNN" style="width: auto;">
                        </div>
                        <div style="font-size: 3rem; color: #666;">‚Üí</div>
                        <div style="flex: 1; text-align: center;">
                            <img src="img/spinnaker.jpg" alt="SpiNNaker"
                                style="width: auto; height: 60mm; max-height: 100%;">
                        </div>
                    </div>
                </section>
                <section>
                  <h2><u> Hardware Representation</u> </h2>
                  <div style="height:0.2cm"></div>
                  <p> But neuromorphics is a young field.</p>
                  <ul>
                    <li class="fragment"> What if your simulator or hardware doesn't support your model? </li>
                    <li class="fragment"> What if an iteration of your existing network isn't supported by your simulator or hardware? </li>
                    <li class="fragment"> What if your hardware doesn't have the representational accuracy required? </li>
                    <li class="fragment"> What if you no longer have access to the hardware and need to use something else? </li>
                    <li class="fragment"> How can you evaluate your algorithm across various hardware paradigms? </li>
                    <li class="fragment"> &hellip; </li>
                  </ul>
                  <div style="height:0.5cm"></div>
                  <p class="fragment"> You're stuck! Porting your code is costly and unreliable.
                </section>

                <section>
                  <h2><u> Why? </u> </h2>
                  <img src="img/fig.png" alt="paper" style="width: auto; height: 150mm; max-height: 100%;">
                  <p> Frenkel, Charlotte, David Bol, and Giacomo Indiveri. "Bottom-up and top-down approaches for the design of neuromorphic processing systems: Tradeoffs and synergies between natural and artificial intelligence." Proceedings of the IEEE 111.6 (2023): 623-652. </p>
                </section>

                <section>
                  <h2><u> Bottom-Up Hardware </u> </h2>
                  <div style="height:0.5cm"></div>
                  <p> Most common, at many different scales & types. </p>
                  <div style="display: flex; gap: 2rem; align-items: flex-start;">
                    <!-- Column 1 -->
                    <div class="fragment" data-fragment-index="1" style="flex: 1; text-align: center;">
                      <img src="img/memristor.png" alt="Image 1" style="width: 100%; max-width: 500px; height: 500px; object-fit: contain; margin-bottom: 0.5rem;">
                      <p style="font-size: 0.9em; margin: 0.5rem 0;">Analogue Memristor Arrays <br> (1024 synapses)</p>
                      <p style="font-size: 0.7em; color: #666; margin: 0;">Ongoing work at University of Southampton</p>
                    </div>

                    <!-- Dividing line 1 -->
                    <div style="width: 2px; background: #ccc;"></div>

                    <!-- Column 2 -->
                    <div class="fragment" data-fragment-index="2" style="flex: 1; text-align: center;">
                      <img src="img/odin.png" alt="Image 2" style="width: 100%; max-width: 500px; height: 500px; object-fit: contain; margin-bottom: 0.5rem;">
                      <p style="font-size: 0.9em; margin: 0.5rem 0;">ODIN on ASIC <br> (64k synapses, 256 neurons)</p>
                      <p style="font-size: 0.7em; color: #666; margin: 0;">Frenkel, Charlotte, et al. "A 0.086-mm&sup2; 12.7-pJ/SOP 64k-synapse 256-neuron online-learning digital spiking neuromorphic processor in 28-nm CMOS." IEEE transactions on biomedical circuits and systems 13.1 (2018): 145-158.</p>
                    </div>

                    <!-- Dividing line 2 -->
                    <div style="width: 2px; background: #ccc;"></div>

                    <!-- Column 3 -->
                    <div class="fragment" data-fragment-index="3" style="flex: 1; text-align: center;">
                      <img src="img/spinnbig.jpg" alt="Image 3" style="width: 100%; max-width: 700px; height: 500px; object-fit: contain; margin-bottom: 0.5rem;">
                      <p style="font-size: 0.9em; margin: 0.5rem 0;">SpiNNaker with ARM <br> (up to 1B neurons & 1T synapses)</p>
                      <p style="font-size: 0.7em; color: #666; margin: 0;">Furber, Steve B., et al. "The spinnaker project." Proceedings of the IEEE 102.5 (2014): 652-665.</p>
                    </div>
                  </div>
                </section>

                <section>
                  <h2><u> Top-Down </u> </h2>
                  <p> Dedicated & optimized to a specific algorithm. </p>
                  <div style="display: flex; gap: 2rem; align-items: flex-start;">
                    <!-- Column 1 -->
                    <div class="fragment" data-fragment-index="1" style="flex: 1; text-align: center;">
                      <img src="img/speck1.png" alt="Image 1" style="width: 100%; max-width: 500px; height: 500px; object-fit: contain; margin-bottom: 0.5rem;">                      <p style="font-size: 0.9em; margin: 0.5rem 0;">SPECK <br> Spiking CNN for Sinabs </p>
                      <p style="font-size: 0.6em; color: #666; margin: 0;">Richter, Ole, et al. "Speck: A smart event-based vision sensor with a low latency 327k neuron convolutional neuronal network processing pipeline." arXiv preprint arXiv:2304.06793 (2023).
</p>
                    </div>

                    <!-- Dividing line 1 -->
                    <div style="width: 2px; background: #ccc;"></div>

                    <div class="fragment" data-fragment-index="2" style="flex: 1; text-align: center;">
                      <img src="img/spoon.png" alt="Image 1" style="width: 100%; max-width: 500px; height: 500px; object-fit: contain; margin-bottom: 0.5rem;">                      <p style="font-size: 0.9em; margin: 0.5rem 0;">SPOON <br> Spiking CNN with RTDP Learning</p>
                      <p style="font-size: 0.6em; color: #666; margin: 0;">Frenkel, Charlotte, Jean-Didier Legat, and David Bol. "A 28-nm convolutional neuromorphic processor enabling online learning with spike-based retinas." 2020 IEEE International Symposium on Circuits and Systems (ISCAS). IEEE, 2020.</p>
                    </div>

                    <!-- Dividing line 2 -->
                    <div style="width: 2px; background: #ccc;"></div>


                    <div class="fragment" data-fragment-index="3" style="flex: 1; text-align: center;">
                      <img src="img/braindrop.png" alt="Image 1" style="width: 100%; max-width: 800px; height: 500px; object-fit: contain; margin-bottom: 0.5rem;">                      <p style="font-size: 0.9em; margin: 0.5rem 0;">BrainDrop <br> Mixed-Signal Neural Engineering Framework (NEF) Accelerator</p>
                      <p style="font-size: 0.6em; color: #666; margin: 0;">Neckar, Alexander, et al. "Braindrop: A mixed-signal neuromorphic architecture with a dynamical systems-based programming model." Proceedings of the IEEE 107.1 (2018): 144-164.</p>
                    </div>


                  </div>
                </section>
                <section>
                  With all this variety of backgrounds and paradigms, how could you unify the neuromorphic acceleration in the same way as ONNX has in machine learning?
                </section>
            </section>
            <section>
                <section>
                    <h2>Introduction to the <br />Neuromorphic Intermediate Representation</h2>
                    <img src="img/nir_logo.png" alt="NIR Logo" style="width: 500px; height: auto; margin-top: 1rem;">
                </section>
                <!-- Historical Context -->
                <section>
                    <h2>The Babel Tower of Neuromorphics</h2>
                    <div class="ecosystem-grid">
                        <div class="platform-box">
                            <h3 style="color: white;">Simulators</h3>
                            <p>BindsNet, Nengo, Norse, snnTorch, Sinabs, Rockpool, Spyx, Lava-dl, ...</p>
                        </div>
                        <div class="platform-box">
                            <h3 style="color: white;">Hardware</h3>
                            <p>CPUs, GPUs, Intel Loihi, SpiNNaker2, SynSense Speck & Xylo, ...</p>
                        </div>
                    </div>
                    <div class="pain-point">
                        <strong>Problem:</strong> "Despite a well-established mathematical foundation for neural
                        dynamics, there exists numerous software and hardware solutions whose variability makes it
                        difficult to reproduce findings."
                    </div>
                </section>

                <section>
                    <h2>The Cost of Fragmentation</h2>
                    <div class="benefit-grid">
                        <div class="benefit-card fragment">
                            <h4>‚è±Ô∏è Research Velocity</h4>
                            <p>Months spent on platform-specific adaptations</p>
                        </div>
                        <div class="benefit-card fragment">
                            <h4>üîÑ Reproducibility Crisis</h4>
                            <p>Studies can't be validated across platforms</p>
                        </div>
                        <div class="benefit-card fragment">
                            <h4>üöß Innovation Barriers</h4>
                            <p>Hardware-software co-design slowed by incompatibility</p>
                        </div>
                    </div>
                </section>

                <section>
                    <h2>Not a new problem...</h2>
                    <ul>
                        <li class="fragment"> NeuroML (2001): Standardized models. Not widely
                            adopted for hardware implementations. </li>
                        <li class="fragment"> NineML (2008): Focused on biological realism but lacked hardware
                            abstraction. </li>
                        <li class="fragment"> PyNN (2009): Provided a common API for simulators but didn't address
                            hardware mapping. </li>
                    </ul>
                    <br /><br />
                    <h2 class="fragment">... if they can, we can too!</h2>
                    <img src="https://imgs.xkcd.com/comics/standards.png" alt="XKCD Standards"
                        style="width: 50%; height: auto; margin-top: 1rem;" class="fragment">
                </section>

                <section>
                    <h2>Really not a new problem</h2>
                    <div class="timeline fragment">
                        <div class="timeline-item">
                            <h4>1950s-60s</h4>
                            <p>CPU Fragmentation</p>
                            <small>IBM, CDC, Burroughs...</small>
                        </div>
                        <div class="timeline-arrow">‚Üí</div>
                        <div class="timeline-item">
                            <h4>1970s-80s</h4>
                            <p>Standardization</p>
                            <small>Common instruction sets (x86, RISC, ...)</small>
                        </div>
                        <div class="timeline-arrow">‚Üí</div>
                        <div class="timeline-item">
                            <h4>Today</h4>
                            <p>Portable Software</p>
                            <small>Write once, run anywhere</small>
                        </div>
                    </div>
                    <div class="timeline fragment">
                        <div class="timeline-item">
                            <h4>2010s</h4>
                            <p>ML Fragmentation</p>
                            <small>TensorFlow, PyTorch, Caffe, Theano...</small>
                        </div>
                        <div class="timeline-arrow">‚Üí</div>
                        <div class="timeline-item">
                            <h4>ONNX Era</h4>
                            <p>Standardization</p>
                            <small>Intermediate representations</small>
                        </div>
                        <div class="timeline-arrow">‚Üí</div>
                        <div class="timeline-item">
                            <h4>Today</h4>
                            <p>Seamless Deployment</p>
                            <small>Train anywhere, deploy everywhere</small>
                        </div>
                    </div>
                    <p class="fragment">What's the common denominator?</p>
                </section>

                <!-- NIR Design Principles -->
                <section>
                    <h2>Instruction axioms</h2>
                    <ol>
                        <li>Computational primitives
                            <ul>
                                <li>Idealized ODE</li>
                                <li>Unambiguous parameterization</li>
                                <li>Composes</li>
                            </ul>
                        </li>
                        <li class="fragment">Graph representation
                            <ul>
                                <li>Nodes as primitives</li>
                                <li>Edges as dataflow</li>
                            </ul>
                        </li>
                    </ol>
                </section>

                <!-- NIR ODE Primitives -->

                <!-- Show graphs -->

                <!-- Existing Platforms + Future Work -->
            </section>
            <section>
                <section>
                    <h2>Motivating a NIR &rarr; FPGA compiler</h2>
                </section>
            </section>
            <section>
                <section>
                    <h2>Compilation demonstration</h2>
                </section>
            </section>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/dist/reveal.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/plugin/notes/notes.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/plugin/markdown/markdown.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/plugin/highlight/highlight.js"></script>
    <script>
        Reveal.initialize({
            hash: true,
            plugins: [RevealMarkdown, RevealHighlight, RevealNotes],
            width: 1920,
            height: 1080
        });
    </script>
</body>

</html>